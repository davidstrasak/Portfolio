<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>David Strašák - Mechatronik</title>
    <link rel="stylesheet" href="../style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Kode+Mono:wght@400..700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" type="image/x-icon" href="../images/icon.jpg" />
  </head>
  <body>
    <header class="headercontainer"></header>
    <script src="../loadHeader_ProjectPages.js"></script>
    <div class="main project">
      <img
        style="float: right"
        src="../images/TableRows.gif"
        width="60%"
        height="30%"
      />
      <div>
        <h2>Lessons learned:</h2>
        <ul style="width: 30%">
          <li>Working with a VBA project.</li>
          <li>Learning with worksheet events.</li>
          <li>
            Experienced countless recursion crashes due to using worksheet
            events.
          </li>
          <li>
            Writing scripts that jump from one place to another, just like the
            good old days.
          </li>
        </ul>
        <h2>Description</h2>
        <p style="width: 100%">
          I've been able to write several tens of thousands lines of VBA code
          thanks to my internship at Honeywell (and an excel VBA course).
        </p>
        <p style="width: 100%">
          While writing these codes, there are some functions that have stood
          the test of time and that I've been using in multiple projects - this
          function is one of those.
        </p>
        <p style="width: 100%">
          The macros I've written are mostly for ease of use, or to update
          calculation tables when new data is added - to make sure calculations
          are correct.
        </p>
        <p style="width: 100%">
          This sub specifically uses the Worksheet_SelectionChange event which
          happens whenever a new cell is selected, data is added, etc. -
          basically any change ever. It tests if the last row of a table is
          full, and if it is, it will add a new row.
        </p>
        <p style="width: 100%">
          In addition to that, this macro copies or deletes the content of the
          cells (which is added with the rows), so the cells have formulas, or
          are empty, where needed.
        </p>
        <h2>Code:</h2>
        <pre>
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  ''THIS ALWAYS ADDS A ROW AT THE END OF THE TABLE
  If Not IsEmpty(Range("Table1").Resize(1, 1).Offset(Range("Table1").Rows.Count - 1).Value) Then
    Application.ScreenUpdating = False 'this makes all of this faster
    Application.Calculation = xlManual
    Call AddRow
    Sheet1.Calculate
    Application.Calculation = xlAutomatic
    Application.ScreenUpdating = True
  End If
End Sub

Private Sub AddRow()
'' Macro that adds lines to the Table1 table
    Dim CountedRows As Integer, usedTable As String
    usedTable = "Table1"
          
    CountedRows = Range(usedTable).Rows.Count

    If Not IsEmpty(Range(usedTable).Resize(1, 1).Offset(CountedRows - 1).Value) Then
    Range(usedTable).Resize(1).Offset(CountedRows).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Range(usedTable).Resize(1).Offset(CountedRows).Value = Range(usedTable).Resize(1).Value
    Application.CutCopyMode = False
    Range(usedTable).Resize(1, 2).Offset(CountedRows).ClearContents
    Range(usedTable).Resize(1, 1).Offset(CountedRows, 2).FillDown
End If
End Sub

        </pre>
      </div>
    </div>
  </body>
  <script src="../any.js"></script>
</html>
